<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HanjaPass Pro - Super Cute Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>
    <style>
        body { background: #fefeff; font-family: 'Pretendard', 'Malgun Gothic', sans-serif; -webkit-tap-highlight-color: transparent; }
        .word-card { background: white; border-radius: 35px; box-shadow: 0 10px 30px rgba(79, 70, 229, 0.05); position: relative; overflow: hidden; border: 2px solid #f1f5f9; }
        .active-tab { background: #6366f1 !important; color: white !important; transform: scale(1.05); box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3); }
        .tab-btn { flex: 1; padding: 14px 0; border-radius: 18px; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); color: #94a3b8; font-weight: 800; font-size: 13px; }
        .paywall-overlay { position: absolute; inset: 0; background: rgba(255, 255, 255, 0.92); backdrop-filter: blur(10px); display: flex; align-items: center; justify-content: center; z-index: 30; }
        
        /* èŒç³»å–‡å­åŠ¨ç”» */
        .btn-hop:active { transform: scale(0.9); }
    </style>
</head>
<body class="p-5 max-w-md mx-auto pb-24">

    <div class="flex items-center justify-between mb-8 mt-4 bg-white p-5 rounded-[32px] shadow-sm border border-slate-50">
        <div class="flex items-center gap-3">
            <div class="bg-indigo-100 w-12 h-12 rounded-2xl flex items-center justify-center text-3xl">ğŸ¼</div>
            <div>
                <h1 class="text-xl font-black text-slate-800 leading-none">HanjaPass</h1>
                <span class="text-[10px] font-bold text-indigo-400 tracking-widest uppercase">Premium Edu</span>
            </div>
        </div>
        <select id="voiceSet" class="bg-slate-100 text-slate-600 text-[11px] font-extrabold p-2.5 rounded-2xl outline-none border-none cursor-pointer">
            <option value="child">ğŸ­ ì–´ë¦°ì´ (Cute)</option>
            <option value="pro">ğŸ™ï¸ ì•„ë‚˜ìš´ì„œ (Pro)</option>
        </select>
    </div>

    <div id="tabBar" class="flex bg-slate-100 p-2 rounded-[24px] mb-8 font-bold"></div>

    <div id="container" class="space-y-8"></div>

    <div id="strokeModal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden z-50 flex items-center justify-center p-8" onclick="closeStroke()">
        <div class="bg-white p-8 rounded-[45px] w-full max-w-[340px] shadow-2xl" onclick="event.stopPropagation()">
            <div id="character-target" class="w-full aspect-square mb-6 mx-auto bg-slate-50 rounded-[30px] border-4 border-dashed border-slate-200"></div>
            <p id="stroke-text" class="font-black text-6xl text-indigo-600 mb-6"></p>
            <button onclick="closeStroke()" class="bg-indigo-50 text-indigo-600 px-8 py-4 rounded-[25px] font-black text-sm w-full btn-hop">ì°½ ë‹«ê¸°</button>
        </div>
    </div>

    <script>
        let globalData = {};
        const FREE_LIMIT = 5;

        // å¯çˆ±å°å–‡å­ SVG å›¾æ ‡ç»„ä»¶
        const speakerIcon = `
            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10.5 4.58656C10.5 3.84074 9.62094 3.44315 9.06066 3.93589L5.43934 7.12456H3C2.44772 7.12456 2 7.57228 2 8.12456V15.8746C2 16.4268 2.44772 16.8746 3 16.8746H5.43934L9.06066 20.0632C9.62094 20.556 10.5 20.1584 10.5 19.4126V4.58656Z" fill="currentColor"/>
                <path d="M14 8C14.5 9 14.5 15 14 16" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                <path d="M17 6C18.5 8 18.5 16 17 18" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
            </svg>
        `;

        async function initApp() {
            try {
                const response = await fetch('data.json');
                globalData = await response.json();
                createTabs();
                render(Object.keys(globalData)[0]);
            } catch (e) { console.error("Data error"); }
        }

        function createTabs() {
            const tabBar = document.getElementById('tabBar');
            Object.keys(globalData).forEach(mode => {
                const btn = document.createElement('button');
                btn.className = 'tab-btn';
                btn.id = `tab-${mode}`;
                btn.innerText = mode.toUpperCase();
                btn.onclick = () => render(mode);
                tabBar.appendChild(btn);
            });
        }

        function render(mode) {
            const list = document.getElementById('container');
            list.innerHTML = '';
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active-tab'));
            document.getElementById(`tab-${mode}`).classList.add('active-tab');

            globalData[mode].forEach((item, index) => {
                const isLocked = index >= FREE_LIMIT;
                const card = document.createElement('div');
                card.className = 'word-card p-7 mb-4';

                let html = `
                    <div class="${isLocked ? 'blur-md' : ''}">
                        <div class="flex justify-between items-start mb-6">
                            <div class="flex-1">
                                <div class="flex gap-2 mb-4">
                                    <span class="px-3 py-1 bg-indigo-600 text-white rounded-full text-[10px] font-black uppercase tracking-widest">Hanja: ${item.hj}</span>
                                    <span class="px-3 py-1 bg-rose-100 text-rose-600 rounded-full text-[10px] font-black underline underline-offset-2">${item.trans}</span>
                                </div>
                                <div class="flex items-end gap-3">
                                    <span class="text-5xl font-black text-slate-800 tracking-tighter">${item.cn}</span>
                                    <span class="text-xl font-black text-rose-500 pb-1">${item.kr}</span>
                                </div>
                                <p class="text-sm font-bold text-slate-300 font-mono mt-1">${item.py}</p>
                            </div>
                            <div class="flex flex-col gap-3">
                                <button onclick="play('${item.cn}')" class="w-14 h-14 bg-indigo-600 text-white rounded-[22px] flex items-center justify-center shadow-lg shadow-indigo-200 btn-hop">
                                    ${speakerIcon}
                                </button>
                                <button onclick="drawSequence('${item.cn}')" class="w-14 h-14 bg-white border-2 border-slate-100 text-slate-400 rounded-[22px] flex flex-col items-center justify-center btn-hop">
                                    <span class="text-[9px] font-black text-orange-500 leading-none">íšìˆœ</span>
                                    <span class="text-[11px] font-black text-orange-600">ë³´ê¸°</span>
                                </button>
                            </div>
                        </div>

                        <div class="pt-6 border-t-2 border-dashed border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-[10px] font-black text-slate-400 bg-slate-50 px-3 py-1 rounded-lg">BUSINESS DIALOGUE</span>
                                ${item.video_url ? `
                                    <button onclick="window.open('${item.video_url}')" class="flex items-center gap-2 bg-rose-500 text-white px-4 py-2.5 rounded-2xl shadow-md active:scale-95 transition-all btn-hop">
                                        <div class="bg-white/20 p-1 rounded-full"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M4.5 3.5v13L16 10z"/></svg></div>
                                        <span class="text-[11px] font-black">ì˜ìƒí•™ìŠµ</span>
                                    </button>
                                ` : ''}
                            </div>
                            <div class="bg-indigo-50/50 p-5 rounded-[28px] relative">
                                <p class="text-slate-600 text-xs font-bold mb-3 leading-relaxed">"${item.sentence_kr}"</p>
                                <p class="text-slate-900 font-black text-[15px] mb-2 pr-10">${item.sentence_cn}</p>
                                <p class="text-rose-500 text-[12px] font-black">${item.sentence_read}</p>
                                <button onclick="play('${item.sentence_cn}')" class="absolute bottom-4 right-4 text-indigo-600 hover:scale-110 transition-transform btn-hop">
                                    ${speakerIcon.replace('w-6 h-6', 'w-8 h-8')}
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                if (isLocked) {
                    html += `
                        <div class="paywall-overlay">
                            <div class="bg-white p-8 rounded-[40px] shadow-2xl border border-indigo-50 text-center mx-6">
                                <div class="w-16 h-16 bg-indigo-50 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl">ğŸ</div>
                                <p class="font-black text-slate-800 text-xl mb-2">ë¬´ì œí•œ í•™ìŠµ ì‹œì‘í•˜ê¸°</p>
                                <p class="text-slate-400 text-xs mb-6 font-medium leading-normal">êµ¬ë…ì„ í†µí•´ ëª¨ë“  ë‹¨ì–´ì™€<br>ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ìƒì„ í™•ì¸í•´ë³´ì„¸ìš”!</p>
                                <button onclick="alert('ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™')" class="w-full bg-indigo-600 text-white py-4 rounded-[22px] font-black text-sm shadow-xl shadow-indigo-100 btn-hop">ë©¤ë²„ì‹­ ê°€ì…</button>
                            </div>
                        </div>
                    `;
                }

                card.innerHTML = html;
                list.appendChild(card);
            });
        }

        async function drawSequence(word) {
            document.getElementById('strokeModal').style.display = 'flex';
            const target = document.getElementById('character-target');
            const textDisplay = document.getElementById('stroke-text');
            for (let char of word) {
                target.innerHTML = '';
                textDisplay.innerText = char;
                const writer = HanziWriter.create('character-target', char, {
                    width: 260, height: 260, padding: 30, strokeColor: '#6366f1',
                    radicalColor: '#f43f5e', strokeAnimationSpeed: 2, delayBetweenStrokes: 120
                });
                await writer.animateCharacter();
                await new Promise(r => setTimeout(r, 800));
            }
        }

        function play(text) {
            window.speechSynthesis.cancel();
            const utter = new SpeechSynthesisUtterance(text);
            const mode = document.getElementById('voiceSet').value;
            utter.lang = 'zh-CN';
            if (mode === 'child') { utter.pitch = 1.6; utter.rate = 1.1; }
            else { utter.pitch = 0.95; utter.rate = 0.85; }
            window.speechSynthesis.speak(utter);
        }

        function closeStroke() { document.getElementById('strokeModal').style.display = 'none'; }
        initApp();
    </script>
</body>
</html>
