<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI í•œì ì„ ìƒë‹˜</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
    }
    .ai-box {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 320px;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.2);
      overflow: hidden;
    }
    .ai-header {
      background: #111;
      color: #fff;
      padding: 10px 14px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .ai-body {
      padding: 14px;
      font-size: 14px;
    }
    .ai-msg {
      background: #f2f2f2;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      white-space: pre-wrap;
    }
    .ai-input {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }
    .ai-input input {
      flex: 1;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    .ai-input button {
      background: #e38b29;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0 14px;
      cursor: pointer;
    }
    .ai-error {
      color: #b00020;
      font-size: 13px;
      margin-top: 6px;
    }
    .ai-footer {
      font-size: 11px;
      color: #777;
      margin-top: 6px;
      text-align: center;
    }
  </style>
</head>

<body>

<div class="ai-box">
  <div class="ai-header">
    AI í•œì ì„ ìƒë‹˜
    <span style="cursor:pointer" onclick="document.querySelector('.ai-box').style.display='none'">âœ•</span>
  </div>

  <div class="ai-body">
    <div class="ai-msg" id="aiReply">
ì•ˆë…•í•˜ì„¸ìš”! ğŸ˜Š  
HSK í•œì ì„ ìƒë‹˜ì…ë‹ˆë‹¤.  
ê¶ê¸ˆí•œ ë‹¨ì–´ë‚˜ ì˜ˆë¬¸ / ë¬¸ë²• / ë¹„ìŠ·í•œ í‘œí˜„ì„ ë¬¼ì–´ë³´ì„¸ìš”!
    </div>

    <div class="ai-input">
      <input id="userInput" placeholder="ì˜ˆ: ä½ å¥½ ëœ»ì´ ë­ì˜ˆìš”?" />
      <button onclick="askAI()">ë³´ë‚´ê¸°</button>
    </div>

    <div class="ai-error" id="aiError"></div>

    <div class="ai-footer">
      ğŸ”’ Key ë³´í˜¸ ëª¨ë“œ Â· /api/gemini
    </div>
  </div>
</div>

<script>
async function askAI() {
  const input = document.getElementById("userInput");
  const replyBox = document.getElementById("aiReply");
  const errorBox = document.getElementById("aiError");

  const message = input.value.trim();
  if (!message) return;

  errorBox.textContent = "";
  replyBox.textContent = "âœï¸ ìƒê° ì¤‘ì´ì—ìš”...";

  try {
    const res = await fetch("/api/gemini", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    message: userInput
  })
});

    const data = await res.json();

    if (!res.ok || data.error) {
      throw new Error(data.error || "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜");
    }

    replyBox.textContent = data.text || "ì‘ë‹µì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.";
    input.value = "";
  } catch (err) {
    replyBox.textContent = "âŒ ë‹µë³€ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆì–´ìš”.";
    errorBox.textContent = err.message;
  }
}
</script>

</body>
</html>


