<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HanjaPass PRO - HSK í•œì/ë‹¨ì–´ í•™ìŠµ</title>

  <!-- Tailwind CDN (ê°œë°œ/ë°ëª¨ìš©) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { background: #f8fafc; font-family: "Malgun Gothic","Apple SD Gothic Neo",system-ui,sans-serif; }
    .card { background: white; border: 1px solid rgba(0,0,0,.06); box-shadow: 0 8px 24px rgba(0,0,0,.05); }
    .pill { border: 1px solid rgba(0,0,0,.08); }
    .btn { border: 1px solid rgba(0,0,0,.08); }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    .ai-panel { position: fixed; right: 20px; bottom: 20px; width: 360px; max-width: calc(100vw - 40px); z-index: 50; }
    .ai-hidden { display:none; }
    .ai-header { cursor: move; user-select:none; }
    .ai-messages { height: 320px; overflow:auto; }
    .msg-user { background:#f59e0b1a; border:1px solid rgba(245,158,11,.35); }
    .msg-ai { background:#1118270d; border:1px solid rgba(0,0,0,.06); }
    .toast { position: fixed; left: 50%; transform: translateX(-50%); bottom: 16px; z-index: 60; }
  </style>
</head>

<body>
  <header class="max-w-6xl mx-auto px-4 pt-8 pb-4">
    <div class="flex items-start justify-between gap-4">
      <div>
        <h1 class="text-2xl font-bold text-slate-900">HanjaPass PRO</h1>
        <p class="text-slate-600 mt-1">HSK ë‹¨ì–´/í‘œí˜„ì„ ì¹´ë“œë¡œ ë³´ê³ , ì˜ˆë¬¸ê³¼ ë°œìŒê¹Œì§€ í•œ ë²ˆì— í•™ìŠµí•˜ì„¸ìš”.</p>
      </div>

      <div class="flex gap-2">
        <button id="viewCardBtn" class="btn px-3 py-2 rounded-lg bg-white hover:bg-slate-50 text-sm">ë³´ê¸°: ì¹´ë“œ</button>
        <button id="randomBtn" class="btn px-3 py-2 rounded-lg bg-white hover:bg-slate-50 text-sm">ëœë¤ ğŸ²</button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 pb-24">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
      <!-- Left: List -->
      <aside class="lg:col-span-4 card rounded-2xl p-4">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-slate-900">ëª©ë¡</h2>
          <div class="flex gap-2">
            <select id="hskSelect" class="pill rounded-lg px-2 py-1 text-sm bg-white"></select>
            <select id="catSelect" class="pill rounded-lg px-2 py-1 text-sm bg-white"></select>
          </div>
        </div>

        <div class="mt-3">
          <input id="searchInput" class="w-full pill rounded-lg px-3 py-2 text-sm bg-white" placeholder="ê²€ìƒ‰: ì¤‘êµ­ì–´/í•œì/ë³‘ìŒ/í•œêµ­ì–´" />
        </div>

        <div class="mt-3 text-xs text-slate-500">
          ì„ íƒí•œ í•­ëª© ìˆ˜: <span id="countSpan">0</span>
        </div>

        <div id="listBox" class="mt-3 space-y-2 max-h-[62vh] overflow-auto pr-1"></div>
      </aside>

      <!-- Right: Detail -->
      <section class="lg:col-span-8 card rounded-2xl p-5">
        <div class="flex items-center justify-between gap-3">
          <h2 class="font-semibold text-slate-900">ìƒì„¸ ë³´ê¸°</h2>
          <div class="flex gap-2">
            <button id="speakBtn" class="btn px-3 py-2 rounded-lg bg-white hover:bg-slate-50 text-sm">ğŸ”Š ë°œìŒ</button>
            <button id="copyBtn" class="btn px-3 py-2 rounded-lg bg-white hover:bg-slate-50 text-sm">ğŸ“‹ ë³µì‚¬</button>
          </div>
        </div>

        <div id="detailBox" class="mt-4">
          <div class="text-slate-600">
            ì™¼ìª½ì—ì„œ ë‹¨ì–´/í‘œí˜„ì„ ì„ íƒí•´ ì£¼ì„¸ìš” ğŸ™‚
          </div>
        </div>

        <hr class="my-5 border-slate-200" />

        <div>
          <h3 class="font-semibold text-slate-900">AIì—ê²Œ ì§ˆë¬¸í•˜ê¸°</h3>
          <p class="text-sm text-slate-600 mt-1">
            ë‹¨ì–´ ì˜ë¯¸/ì‚¬ìš©ë²•/ì˜ˆë¬¸/ë¹„ìŠ·í•œ í‘œí˜„ ë“±ì„ ë¬¼ì–´ë³´ì„¸ìš”.
          </p>
          <div class="mt-3 flex gap-2">
            <input id="quickAskInput" class="w-full pill rounded-lg px-3 py-2 text-sm bg-white" placeholder="ì˜ˆ: ì´ í‘œí˜„ HSK ëª‡ ê¸‰ì´ì—ìš”? ì˜ˆë¬¸ 3ê°œ ë§Œë“¤ì–´ì¤˜." />
            <button id="openAiBtn" class="btn px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 text-sm">ì—´ê¸°</button>
          </div>

          <div class="mt-3 text-xs text-slate-500">
            âœ… Key ë³´í˜¸ ëª¨ë“œ: <b>/api/gemini</b> ì‚¬ìš© ì¤‘ (í”„ë¡ íŠ¸ì— Key ì—†ìŒ)
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- AI floating button -->
  <button id="aiFab" class="fixed right-5 bottom-5 w-14 h-14 rounded-full bg-slate-900 text-white shadow-lg flex items-center justify-center hover:bg-slate-800 z-40" title="AI í•œì ì„ ìƒë‹˜">
    ğŸ¤–
  </button>

  <!-- AI Panel -->
  <div id="aiPanel" class="ai-panel card rounded-2xl overflow-hidden ai-hidden">
    <div id="aiHeader" class="ai-header flex items-center justify-between px-4 py-3 bg-slate-900 text-white">
      <div class="font-semibold">AI í•œì ì„ ìƒë‹˜</div>
      <button id="aiClose" class="text-white/80 hover:text-white">âœ•</button>
    </div>

    <div class="px-4 py-3">
      <div id="aiMessages" class="ai-messages space-y-2"></div>

      <div class="mt-3 flex gap-2">
        <input id="aiInput" class="w-full pill rounded-lg px-3 py-2 text-sm bg-white" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." />
        <button id="aiSend" class="btn px-4 py-2 rounded-lg bg-amber-600 text-white hover:bg-amber-500 text-sm">ë³´ë‚´ê¸°</button>
      </div>

      <div id="aiHint" class="mt-2 text-xs text-slate-500">
        ìš´ì˜ ê¶Œì¥: Vercel ì„œë²„ë¦¬ìŠ¤(<b>/api/gemini</b>)ë¡œ Key ë³´í˜¸
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast ai-hidden">
    <div class="card rounded-xl px-4 py-2 text-sm text-slate-800"></div>
  </div>

  <script>
    // -----------------------------
    // Global state
    // -----------------------------
    let globalData = null;
    let currentHSK = null;
    let currentCat = null;
    let currentItem = null;
    let viewMode = "card"; // card only now
    let allItemsCache = []; // flattened items for searching/random

    // -----------------------------
    // Helpers
    // -----------------------------
    function $(id){ return document.getElementById(id); }

    function toast(msg){
      const t = $("toast");
      t.firstElementChild.textContent = msg;
      t.classList.remove("ai-hidden");
      setTimeout(()=>t.classList.add("ai-hidden"), 1800);
    }

    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function safeText(v){ return (v === null || v === undefined) ? "" : String(v); }

    function buildFlatItems(){
      allItemsCache = [];
      if(!globalData) return;
      // globalData example: { "HSK1": { "Greeting": [ {...}, ... ], ... } }
      for (const hsk of Object.keys(globalData)){
        const catsObj = globalData[hsk] || {};
        for (const cat of Object.keys(catsObj)){
          const arr = catsObj[cat] || [];
          for (const item of arr){
            allItemsCache.push({ hsk, cat, item });
          }
        }
      }
    }

    function normalizeForSearch(s){
      return safeText(s).toLowerCase().replace(/\s+/g,"").trim();
    }

    function itemSearchKey(x){
      const it = x.item || {};
      return normalizeForSearch(
        (it.cn||"") + (it.hj||"") + (it.py||"") + (it.kr||"") + (it.trans||"") + (it.sentence_cn||"") + (it.sentence_kr||"")
      );
    }

    // -----------------------------
    // Rendering
    // -----------------------------
    function renderHSKOptions(){
      const sel = $("hskSelect");
      sel.innerHTML = "";
      const keys = Object.keys(globalData || {});
      if(keys.length === 0) return;
      for(const k of keys){
        const opt = document.createElement("option");
        opt.value = k;
        opt.textContent = k;
        sel.appendChild(opt);
      }
      currentHSK = currentHSK || keys[0];
      sel.value = currentHSK;
    }

    function renderCatOptions(){
      const sel = $("catSelect");
      sel.innerHTML = "";
      const cats = Object.keys((globalData?.[currentHSK]) || {});
      for(const c of cats){
        const opt = document.createElement("option");
        opt.value = c;
        opt.textContent = c;
        sel.appendChild(opt);
      }
      currentCat = currentCat || cats[0] || null;
      if(currentCat) sel.value = currentCat;
    }

    function getCurrentArray(){
      if(!globalData || !currentHSK || !currentCat) return [];
      return (globalData[currentHSK]?.[currentCat]) || [];
    }

    function renderList(){
      const listBox = $("listBox");
      listBox.innerHTML = "";
      const q = normalizeForSearch($("searchInput").value);
      const arr = getCurrentArray();

      let shown = 0;

      arr.forEach((it, idx)=>{
        const key = normalizeForSearch(
          (it.cn||"") + (it.hj||"") + (it.py||"") + (it.kr||"") + (it.trans||"") + (it.sentence_cn||"")
        );
        if(q && !key.includes(q)) return;

        shown++;
        const btn = document.createElement("button");
        btn.className = "w-full text-left card rounded-xl p-3 hover:bg-slate-50 transition";
        btn.innerHTML = `
          <div class="flex items-start justify-between gap-3">
            <div>
              <div class="text-lg font-bold text-slate-900">${escapeHtml(it.cn || "")}</div>
              <div class="text-sm text-slate-600 mt-1">${escapeHtml(it.py || "")} Â· ${escapeHtml(it.kr || "")}</div>
            </div>
            <div class="text-xs text-slate-500">${escapeHtml(it.hj || "")}</div>
          </div>
          <div class="text-xs text-slate-500 mt-2 line-clamp-2">${escapeHtml(it.trans || "")}</div>
        `;
        btn.onclick = ()=>{
          currentItem = it;
          renderDetail(it);
        };
        listBox.appendChild(btn);
      });

      $("countSpan").textContent = String(shown);
      if(shown === 0){
        listBox.innerHTML = `<div class="text-sm text-slate-500 p-3">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”.</div>`;
      }
    }

    function renderDetail(it){
      if(!it) return;
      const d = $("detailBox");
      const cn = safeText(it.cn);
      const hj = safeText(it.hj);
      const py = safeText(it.py);
      const kr = safeText(it.kr);
      const trans = safeText(it.trans);

      const s_cn = safeText(it.sentence_cn);
      const s_py = safeText(it.sentence_py);
      const s_kr = safeText(it.sentence_kr);

      d.innerHTML = `
        <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4">
          <div>
            <div class="text-4xl font-extrabold text-slate-900">${escapeHtml(cn)}</div>
            <div class="mt-2 flex flex-wrap gap-2">
              ${hj ? `<span class="pill px-2 py-1 rounded-lg text-xs bg-white">í•œì: <b>${escapeHtml(hj)}</b></span>` : ``}
              ${py ? `<span class="pill px-2 py-1 rounded-lg text-xs bg-white">ë³‘ìŒ: <b>${escapeHtml(py)}</b></span>` : ``}
              ${kr ? `<span class="pill px-2 py-1 rounded-lg text-xs bg-white">í•œêµ­ì–´: <b>${escapeHtml(kr)}</b></span>` : ``}
              <span class="pill px-2 py-1 rounded-lg text-xs bg-white">${escapeHtml(currentHSK || "")} Â· ${escapeHtml(currentCat || "")}</span>
            </div>
          </div>

          <div class="flex gap-2">
            <button class="btn px-3 py-2 rounded-lg bg-white hover:bg-slate-50 text-sm" onclick="speak('${escapeJs(cn)}')">ğŸ”Š ë‹¨ì–´</button>
            ${s_cn ? `<button class="btn px-3 py-2 rounded-lg bg-white hover:bg-slate-50 text-sm" onclick="speak('${escapeJs(s_cn)}')">ğŸ”Š ì˜ˆë¬¸</button>` : ``}
          </div>
        </div>

        <div class="mt-4">
          <div class="text-sm font-semibold text-slate-900">ëœ»/ì„¤ëª…</div>
          <div class="mt-1 text-slate-700 leading-relaxed">${escapeHtml(trans || "â€”")}</div>
        </div>

        <div class="mt-4">
          <div class="text-sm font-semibold text-slate-900">ì˜ˆë¬¸</div>
          <div class="mt-2 card rounded-xl p-4">
            <div class="text-lg font-semibold text-slate-900">${escapeHtml(s_cn || "â€”")}</div>
            <div class="text-sm text-slate-600 mt-1">${escapeHtml(s_py || "")}</div>
            <div class="text-sm text-slate-700 mt-2">${escapeHtml(s_kr || "")}</div>
          </div>
        </div>
      `;

      // Quick ask placeholder
      $("quickAskInput").value = `${cn} (${py}) ì‚¬ìš©ë²•ì„ ì‰½ê²Œ ì„¤ëª…í•´ì¤˜. ì˜ˆë¬¸ 3ê°œ(ì¤‘êµ­ì–´+ë³‘ìŒ+í•œêµ­ì–´)ë„ ë§Œë“¤ì–´ì¤˜.`;
    }

    // escape for inline onclick speak()
    function escapeJs(str){
      return String(str ?? "")
        .replaceAll("\\","\\\\")
        .replaceAll("'","\\'")
        .replaceAll("\n","\\n");
    }

    // -----------------------------
    // Speech (browser)
    // -----------------------------
    function speak(text){
      try{
        if(!text) return;
        const u = new SpeechSynthesisUtterance(text);
        // Chinese voice if possible
        u.lang = "zh-CN";
        u.rate = 0.95;
        speechSynthesis.cancel();
        speechSynthesis.speak(u);
      }catch(e){
        toast("ì´ ë¸Œë¼ìš°ì €ì—ì„œ ë°œìŒ ê¸°ëŠ¥ì´ ì œí•œë  ìˆ˜ ìˆì–´ìš”.");
      }
    }
    window.speak = speak;

    // -----------------------------
    // AI Panel
    // -----------------------------
    function addMsg(role, text){
      const box = $("aiMessages");
      const div = document.createElement("div");
      div.className = `rounded-xl p-3 text-sm ${role === "user" ? "msg-user" : "msg-ai"}`;
      div.innerHTML = `<div class="whitespace-pre-wrap">${escapeHtml(text)}</div>`;
      box.appendChild(div);
      box.scrollTop = box.scrollHeight;
    }

    async function callAI(userText){
      const context = currentItem ? {
        hsk: currentHSK,
        category: currentCat,
        cn: currentItem.cn,
        hj: currentItem.hj,
        py: currentItem.py,
        kr: currentItem.kr,
        trans: currentItem.trans,
        sentence_cn: currentItem.sentence_cn,
        sentence_py: currentItem.sentence_py,
        sentence_kr: currentItem.sentence_kr
      } : null;

      const res = await fetch("/api/gemini", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: userText, context })
      });

      // server should return: { text: "..." }
      const data = await res.json().catch(()=> ({}));
      if(!res.ok){
        const err = data?.error || data?.message || `HTTP ${res.status}`;
        throw new Error(err);
      }
      const text = data?.text || data?.output || data?.result || "";
      if(!text) throw new Error("ì‘ë‹µì´ ë¹„ì–´ ìˆì–´ìš”.");
      return text;
    }

    async function sendAI(){
      const input = $("aiInput");
      const btn = $("aiSend");
      const msg = (input.value || "").trim();
      if(!msg) return;

      addMsg("user", msg);
      input.value = "";
      btn.disabled = true;
      btn.textContent = "ì „ì†¡ì¤‘â€¦";

      try{
        const reply = await callAI(msg);
        addMsg("ai", reply);
      }catch(e){
        addMsg("ai", `ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n${e.message}\n\n(ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.)`);
      }finally{
        btn.disabled = false;
        btn.textContent = "ë³´ë‚´ê¸°";
      }
    }

    function openAI(){
      $("aiPanel").classList.remove("ai-hidden");
      $("aiFab").classList.add("ai-hidden");
      // greeting
      if($("aiMessages").children.length === 0){
        addMsg("ai", "ì•ˆë…•í•˜ì„¸ìš”! HSK í•œì ì„ ìƒë‹˜ì…ë‹ˆë‹¤ ğŸ˜Š\nê¶ê¸ˆí•œ ë‹¨ì–´ë‚˜ ì˜ˆë¬¸/ë¬¸ë²•/ë¹„ìŠ·í•œ í‘œí˜„ì„ ë¬¼ì–´ë³´ì„¸ìš”!");
      }
      setTimeout(()=> $("aiInput").focus(), 50);
    }

    function closeAI(){
      $("aiPanel").classList.add("ai-hidden");
      $("aiFab").classList.remove("ai-hidden");
    }

    // draggable
    (function enableDrag(){
      const panel = $("aiPanel");
      const header = $("aiHeader");
      let dragging = false, startX=0, startY=0, startLeft=0, startTop=0;

      header.addEventListener("mousedown", (e)=>{
        dragging = true;
        const rect = panel.getBoundingClientRect();
        startX = e.clientX; startY = e.clientY;
        startLeft = rect.left; startTop = rect.top;
        panel.style.right = "auto";
        panel.style.bottom = "auto";
        panel.style.left = startLeft + "px";
        panel.style.top = startTop + "px";
      });

      window.addEventListener("mousemove", (e)=>{
        if(!dragging) return;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;
        panel.style.left = (startLeft + dx) + "px";
        panel.style.top  = (startTop + dy) + "px";
      });

      window.addEventListener("mouseup", ()=>{
        dragging = false;
      });
    })();

    // -----------------------------
    // Init
    // -----------------------------
    async function initApp(){
      try{
        const r = await fetch("data.json?t=" + Date.now());
        if(!r.ok) throw new Error("data.json ë¡œë“œ ì‹¤íŒ¨: " + r.status);
        globalData = await r.json();

        buildFlatItems();

        renderHSKOptions();
        renderCatOptions();
        renderList();
      }catch(e){
        document.body.innerHTML = `
          <div class="max-w-3xl mx-auto p-6">
            <div class="card rounded-2xl p-5">
              <div class="text-xl font-bold text-red-600">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>
              <div class="mt-2 text-slate-700">${escapeHtml(e.message)}</div>
              <div class="mt-3 text-sm text-slate-500">
                í™•ì¸: data.json íŒŒì¼ì´ ê°™ì€ í´ë”ì— ìˆê³ , JSON ë¬¸ë²• ì˜¤ë¥˜ê°€ ì—†ëŠ”ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”.
              </div>
            </div>
          </div>
        `;
      }
    }

    // Events
    $("hskSelect").addEventListener("change", ()=>{
      currentHSK = $("hskSelect").value;
      currentCat = null;
      renderCatOptions();
      renderList();
      currentItem = null;
      $("detailBox").innerHTML = `<div class="text-slate-600">ì™¼ìª½ì—ì„œ ë‹¨ì–´/í‘œí˜„ì„ ì„ íƒí•´ ì£¼ì„¸ìš” ğŸ™‚</div>`;
    });

    $("catSelect").addEventListener("change", ()=>{
      currentCat = $("catSelect").value;
      renderList();
      currentItem = null;
      $("detailBox").innerHTML = `<div class="text-slate-600">ì™¼ìª½ì—ì„œ ë‹¨ì–´/í‘œí˜„ì„ ì„ íƒí•´ ì£¼ì„¸ìš” ğŸ™‚</div>`;
    });

    $("searchInput").addEventListener("input", ()=>{
      renderList();
    });

    $("randomBtn").addEventListener("click", ()=>{
      if(allItemsCache.length === 0) return;
      // prefer current hsk & cat, else global random
      const pool = allItemsCache.filter(x => x.hsk === currentHSK && x.cat === currentCat);
      const usePool = pool.length ? pool : allItemsCache;
      const pick = usePool[Math.floor(Math.random() * usePool.length)];
      currentHSK = pick.hsk;
      currentCat = pick.cat;
      $("hskSelect").value = currentHSK;
      renderCatOptions();
      $("catSelect").value = currentCat;
      renderList();
      currentItem = pick.item;
      renderDetail(pick.item);
      toast("ëœë¤ ì„ íƒ!");
    });

    $("speakBtn").addEventListener("click", ()=>{
      if(!currentItem) return toast("ë¨¼ì € ë‹¨ì–´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");
      speak(currentItem.cn || "");
    });

    $("copyBtn").addEventListener("click", async ()=>{
      if(!currentItem) return toast("ë¨¼ì € ë‹¨ì–´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");
      const t = [
        `HSK: ${currentHSK}`,
        `ì¹´í…Œê³ ë¦¬: ${currentCat}`,
        `ì¤‘êµ­ì–´: ${currentItem.cn || ""}`,
        `í•œì: ${currentItem.hj || ""}`,
        `ë³‘ìŒ: ${currentItem.py || ""}`,
        `í•œêµ­ì–´: ${currentItem.kr || ""}`,
        `ëœ»: ${currentItem.trans || ""}`,
        `ì˜ˆë¬¸: ${currentItem.sentence_cn || ""}`,
        `ì˜ˆë¬¸(ë³‘ìŒ): ${currentItem.sentence_py || ""}`,
        `ì˜ˆë¬¸(í•œêµ­ì–´): ${currentItem.sentence_kr || ""}`
      ].join("\n");
      try{
        await navigator.clipboard.writeText(t);
        toast("ë³µì‚¬ ì™„ë£Œ!");
      }catch(e){
        toast("ë³µì‚¬ ì‹¤íŒ¨(ë¸Œë¼ìš°ì € ê¶Œí•œ í™•ì¸).");
      }
    });

    $("aiFab").addEventListener("click", openAI);
    $("aiClose").addEventListener("click", closeAI);
    $("openAiBtn").addEventListener("click", ()=>{
      openAI();
      const q = ($("quickAskInput").value || "").trim();
      if(q){
        $("aiInput").value = q;
        sendAI();
      }
    });

    $("aiSend").addEventListener("click", sendAI);
    $("aiInput").addEventListener("keydown", (e)=>{
      if(e.key === "Enter") sendAI();
    });

    initApp();
  </script>
</body>
</html>
