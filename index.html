<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI í•œì ì„ ìƒë‹˜</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background:#f7f7f7; }
    .chat-box { max-height: 60vh; overflow-y: auto; }
    .bubble { white-space: pre-wrap; word-break: break-word; }
    .no-select { user-select: none; }

    /* âœ… æœå†»ç‚¹å‡»æœ—è¯»å— */
    .jelly {
      display: inline-block;
      padding: 10px 12px;
      margin: 6px 0;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.70);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 165, 0, 0.28);
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      cursor: pointer;
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .jelly:hover{ transform: translateY(-1px); box-shadow: 0 10px 22px rgba(0,0,0,0.10); }
    .jelly:active{ transform: translateY(0px) scale(0.99); }
    .jellyWrap { display:flex; flex-direction:column; align-items:flex-start; }
  </style>
</head>

<body class="p-4">

  <!-- æœºå™¨äººæŒ‰é’® -->
  <button onclick="toggleAI()"
    class="fixed bottom-4 right-4 bg-black text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg">
    ğŸ¤–
  </button>

  <!-- é¢æ¿ -->
  <div id="ai-panel"
    class="hidden fixed bottom-20 right-4 w-[390px] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden">

    <!-- âœ… æ‹–åŠ¨æŠŠæ‰‹ï¼šæ ‡é¢˜æ  -->
    <div id="dragHandle"
      class="bg-black text-white px-4 py-2 flex justify-between items-center cursor-move no-select">
      <span id="uiTitle">AI í•œì ì„ ìƒë‹˜</span>
      <button type="button" onclick="toggleAI()">âœ–</button>
    </div>

    <!-- âœ… æ§åˆ¶åŒºï¼šsticky æ°¸è¿œå¯è§ï¼ˆå·²å»æ‰â€œæµ‹è¯•æŒ‰é’®â€/â€œéŸ³è‰²â€/â€œæœ—è¯»èŒƒå›´â€ï¼‰ -->
    <div id="controlBar"
      class="px-3 pt-3 pb-2 border-b text-xs space-y-2 sticky top-0 bg-gradient-to-b from-orange-50 to-white z-10">

      <div class="flex items-center gap-2">
        <input id="ttsToggle" type="checkbox" checked class="accent-orange-500" />
        <label id="uiTtsLabel">ì½ì–´ì£¼ê¸°(TTS)</label>
        <span id="uiAutoVoiceHint" class="ml-auto text-[11px] text-gray-500">
          (ì–¸ì–´=ìŒì„± ìë™)
        </span>
      </div>

      <div class="flex items-center gap-2">
        <span id="uiExplainLabel" class="w-[72px] text-gray-600">ì„¤ëª… ì–¸ì–´</span>
        <select id="explainLang" class="flex-1 border rounded px-2 py-1 text-xs bg-white">
          <option value="ko" selected>í•œêµ­ì–´</option>
          <option value="en">English</option>
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="zh">ä¸­æ–‡</option>
        </select>
      </div>

      <div class="flex items-center gap-2">
        <span id="uiModeLabel" class="w-[72px] text-gray-600">ëª¨ë“œ</span>
        <select id="speakMode" class="flex-1 border rounded px-2 py-1 text-xs bg-white">
          <option value="kids" selected>Kids</option>
          <option value="exam">Exam</option>
        </select>
      </div>

      <div class="text-[11px] text-gray-500 leading-snug">
        ğŸ’¡ ë¬¸ì¥(ì ¤ë¦¬)ì„ í´ë¦­í•˜ë©´ ê·¸ ë¶€ë¶„ë§Œ ì½ì–´ì¤˜ìš”.
      </div>
    </div>

    <!-- èŠå¤©åŒº -->
    <div id="chat" class="chat-box p-3 space-y-2 text-sm"></div>

    <!-- è¾“å…¥åŒº -->
    <div class="p-3 border-t flex gap-2">
      <input id="input" class="flex-1 border rounded px-2 py-2"
        placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”â€¦"
        onkeydown="if(event.key==='Enter') send();" />
      <button id="uiSendBtn" onclick="send()"
        class="bg-orange-500 text-white px-4 py-2 rounded">
        ë³´ë‚´ê¸°
      </button>
    </div>

    <!-- âœ… å·²éšè—å¯†é’¥æç¤ºï¼ˆä¸æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šï¼‰ -->
    <div id="uiKeyMode" class="hidden text-xs text-center text-gray-500 pb-2">
      ğŸ” Key ë³´í˜¸ ëª¨ë“œ: Vercel API
    </div>

  </div>

  <!-- âœ… åˆ†ç¦»åçš„ UI è„šæœ¬ -->
  <script src="./ui.js" defer></script>
</body>
</html>
